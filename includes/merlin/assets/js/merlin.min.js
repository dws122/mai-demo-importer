var Merlin=function(e){function n(){var n=e(".merlin__body"),i=(e(".merlin__body--loading"),e(".merlin__body--exiting"),e("#merlin__drawer-trigger"));drawer_opened="merlin__drawer--open",setTimeout(function(){n.addClass("loaded")},100),i.on("click",function(){n.toggleClass(drawer_opened)}),e(".merlin__button--proceed:not(.merlin__button--closer)").click(function(e){e.preventDefault();var i=this.getAttribute("href");n.addClass("exiting"),setTimeout(function(){window.location=i},400)}),e(".merlin__button--closer").on("click",function(e){n.removeClass(drawer_opened),e.preventDefault();var i=this.getAttribute("href");setTimeout(function(){n.addClass("exiting")},600),setTimeout(function(){window.location=i},1100)}),e(".button-next").on("click",function(n){n.preventDefault();var i=r(this);if(!i)return!1;var t=e(this).data("callback");return!t||"undefined"==typeof l[t]||(l[t](this),!1)}),e(document).on("change",".js-merlin-demo-import-select",function(){var n=e(this).val();e(".js-merlin-select-spinner").show(),e.post(merlin_params.ajaxurl,{action:"merlin_update_selected_import_data_info",wpnonce:merlin_params.wpnonce,selected_index:n},function(n){n.success?e(".js-merlin-drawer-import-content").html(n.data):alert(merlin_params.texts.something_went_wrong),e(".js-merlin-select-spinner").hide()}).fail(function(){e(".js-merlin-select-spinner").hide(),alert(merlin_params.texts.something_went_wrong)})})}function i(){function n(e){"undefined"!=typeof e.done?(setTimeout(function(){s.addClass("lead")},0),setTimeout(function(){s.addClass("success"),s.html(e.message)},600),t()):(s.addClass("lead error"),s.html(e.error))}function i(){jQuery.post(merlin_params.ajaxurl,{action:"merlin_child_theme",wpnonce:merlin_params.wpnonce},n).fail(n)}var t,o=e(".merlin__body"),s=e("#child-theme-text");return{init:function(n){t=function(){setTimeout(function(){e(".merlin__body").addClass("js--finished")},1500),o.removeClass(drawer_opened),setTimeout(function(){e(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=n.href},4e3)},i()}}}function t(){function n(n){"undefined"!=typeof n.success&&n.success?(r.siblings(".error-message").remove(),setTimeout(function(){r.addClass("lead")},0),setTimeout(function(){r.addClass("success"),r.html(n.message)},600),t()):(e(".js-merlin-license-activate-button").removeClass("merlin__button--loading").data("done-loading","no"),r.siblings(".error-message").remove(),s.addClass("has-error"),r.html(n.message),r.siblings(".error-message").addClass("lead error"))}function i(){s.removeClass("has-error"),jQuery.post(merlin_params.ajaxurl,{action:"merlin_activate_license",wpnonce:merlin_params.wpnonce,license_key:e(".js-license-key").val()},n).fail(n)}var t,o=e(".merlin__body"),s=e(".merlin__content--license-key"),r=e("#license-text");return{init:function(n){t=function(){setTimeout(function(){e(".merlin__body").addClass("js--finished")},1500),o.removeClass(drawer_opened),setTimeout(function(){e(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=n.href},4e3)},i()}}}function o(){function n(e){var o=s.find("label");"object"==typeof e&&"undefined"!=typeof e.message?(o.removeClass("installing success error").addClass(e.message.toLowerCase()),"undefined"!=typeof e.done&&e.done?t():"undefined"!=typeof e.url?e.hash==d?(o.removeClass("installing success").addClass("error"),t()):(d=e.hash,jQuery.post(e.url,e,n).fail(n)):t()):i()}function i(){if(l){var e=s.find("input:checkbox");e.is(":checked")?jQuery.post(merlin_params.ajaxurl,{action:"merlin_plugins",wpnonce:merlin_params.wpnonce,slug:l},n).fail(n):(s.addClass("skipping"),setTimeout(t,300))}}function t(){s&&(s.data("done_item")||(a++,s.data("done_item",1)),s.find(".spinner").css("visibility","hidden"));var n=e(".merlin__drawer--install-plugins li");n.each(function(){var n=e(this);return!!n.data("done_item")||(l=n.data("slug"),s=n,i(),!1)}),a>=n.length&&o()}var o,s,r=e(".merlin__body"),a=0,l="",d="";return{init:function(n){e(".merlin__drawer--install-plugins").addClass("installing"),e(".merlin__drawer--install-plugins").find("input").prop("disabled",!0),o=function(){setTimeout(function(){e(".merlin__body").addClass("js--finished")},1e3),r.removeClass(drawer_opened),setTimeout(function(){e(".merlin__body").addClass("exiting")},3e3),setTimeout(function(){window.location.href=n.href},3500)},t()}}}function s(){function n(i){var o=l.find("label");"object"==typeof i&&"undefined"!=typeof i.message?(o.addClass(i.message.toLowerCase()),"undefined"!=typeof i.num_of_imported_posts&&0<p&&(f="all"===i.num_of_imported_posts?p:i.num_of_imported_posts,r()),"undefined"!=typeof i.url?i.hash===_?(o.addClass("status--failed"),t()):(_=i.hash,"undefined"==typeof i.selected_index&&(i.selected_index=e(".js-merlin-demo-import-select").val()||0),jQuery.post(i.url,i,n).fail(n)):("undefined"!=typeof i.done,t())):(console.log(i),o.addClass("status--error"),t())}function i(){if(u){var i=l.find("input:checkbox");i.is(":checked")?jQuery.post(merlin_params.ajaxurl,{action:"merlin_content",wpnonce:merlin_params.wpnonce,content:u,selected_index:e(".js-merlin-demo-import-select").val()||0},n).fail(n):(l.addClass("skipping"),setTimeout(t,300))}}function t(){var n=!1;l&&(l.data("done_item")||(m++,l.data("done_item",1)),l.find(".spinner").css("visibility","hidden"));var t=e(".merlin__drawer--import-content__list-item");e(".merlin__drawer--import-content__list-item input:checked");t.each(function(){""==u||n?(u=e(this).data("content"),l=e(this),i(),n=!1):e(this).data("content")==u&&(n=!0)}),m>=t.length&&a()}function o(){return!!e(".merlin__drawer--import-content__list-item .checkbox-content").is(":checked")&&void jQuery.post(merlin_params.ajaxurl,{action:"merlin_get_total_content_import_items",wpnonce:merlin_params.wpnonce,selected_index:e(".js-merlin-demo-import-select").val()||0},function(e){p=e.data,0<p&&(r(),d=setInterval(function(){f+=p/500,r()},1e3))})}function s(e,n,i){return Math.min(i,Math.max(n,e))}function r(){e(".js-merlin-progress-bar").css("width",f/p*100+"%");var n=s(f/p*100,0,99);e(".js-merlin-progress-bar-percentage").html(Math.round(n)+"%"),1===f/p&&clearInterval(d)}var a,l,d,c=e(".merlin__body"),m=0,u="",_="",f=1,p=0;return{init:function(n){e(".merlin__drawer--import-content").addClass("installing"),e(".merlin__drawer--import-content").find("input").prop("disabled",!0),a=function(){e.post(merlin_params.ajaxurl,{action:"merlin_import_finished",wpnonce:merlin_params.wpnonce,selected_index:e(".js-merlin-demo-import-select").val()||0}),setTimeout(function(){e(".js-merlin-progress-bar-percentage").html("100%")},100),setTimeout(function(){c.removeClass(drawer_opened)},500),setTimeout(function(){e(".merlin__body").addClass("js--finished")},1500),setTimeout(function(){e(".merlin__body").addClass("exiting")},3400),setTimeout(function(){window.location.href=n.href},4e3)},o(),t()}}}function r(e){var n=jQuery(e);if("yes"==n.data("done-loading"))return!1;var i=!1;n.is("input")||n.is("button")?"val":"text";return n.data("done-loading","yes"),n.addClass("merlin__button--loading"),{done:function(){i=!0,n.attr("disabled",!1)}}}var a,l={install_child:function(e){var n=new i;n.init(e)},activate_license:function(e){var n=new t;n.init(e)},install_plugins:function(e){var n=new o;n.init(e)},install_content:function(e){var n=new s;n.init(e)}};return{init:function(){a=this,e(n)},callback:function(e){console.log(e),console.log(this)}}}(jQuery);Merlin.init();